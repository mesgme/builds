// This shows a simple build wrapper example, using the AnsiColor plugin.
node {
    stage ('echo') {
        echo "Hello jenkkins"
    }
    stage ('AWS sync up') {
        git 'https://github.com/mesgme/builds.git'
        withCredentials([[$class: 'AmazonWebServicesCredentialsBinding', accessKeyVariable: 'AWS_ACCESS_KEY_ID', credentialsId: 'MESG AWS', secretKeyVariable: 'AWS_SECRET_ACCESS_KEY']]) {
            sh 'AWS_DEFAULT_REGION=eu-west-2 aws s3 sync $WORKSPACE s3://mesgbucket/folder1'
        }
    }
    stage ('EC2 sync down'){
        withCredentials([sshUserPrivateKey(credentialsId: 'aws_ec2')]) {
            sh 'ssh 35.179.47.76 <<- EOF
                ls
            EOF'
        }
    }
}